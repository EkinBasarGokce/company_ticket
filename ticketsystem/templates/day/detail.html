{% extends 'base.html'%}
{% load static %}
{% load extras %}
{% block content %}

<link rel="stylesheet" type="text/css" href="{% static 'day/style.css' %}">

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Gün - {{ day.date|date:'d-M H:i' }}</title>
</head>
<body>


<h1 align="center">{{ day.event }}</h1>
<div>
<table align="center">
    <tbody align="center">
    <tr>
        {% for d in days %}
        <td class="day{% if d.id == day.id %}1{% else %}0{% endif %}" ><a href="/day/{{d.id}}/" align="center"><h1>{{ d.date|date:'d F H:i' }}</h1></a></td>
        {% endfor %}
    </tr>
    </tbody>
</table>
</div>

<br>

<div align="center">
    <button class="sell" type="submit" onclick="location.href='sell/'">Satış Yap</button>
</div>

<br>

<div align="center">
    <form action="cancel/" method="post">
        {% csrf_token %}
        <label for="tickets">İptal Edilecek Biletler (a-32, b-25...): </label>
        <textarea id="tickets" rows = "1" cols = "20" name = "tickets" required></textarea>
        <input type="submit" value="İptal Et">
    </form>
</div>

<br>

<div>
<table align="center">
    <tbody align="center">

        {% for _, row_list in day.event.hall.seats.items %}
            {% for row_dict in row_list %}
                {% for row, nums in row_dict.items %}
                    {% if row == "-" %}
                        <tr class="walk"><td class="walk"><br></td></tr>
                    {% else %}
                        <tr class="seat">
                            <td class="row"><p>{{ row }}</p></td>
                            <td class="walk"></td>
                            {% for num in nums %}
                                {% if num == "-1" %}
                                    <td class="walk"></td>
                                {% else %}
                                    <td ><button class="seat{{tickets_dict|keyvalue:row|keyvalue:num|keyvalue:1}}{% if user_id == tickets_dict|keyvalue:row|keyvalue:num|keyvalue:2 %}1{% else %}0{% endif %}" onclick="location.href='click/{{tickets_dict|keyvalue:row|keyvalue:num|keyvalue:0}}'" ><p>{{num}}</p></button></td>
                                {% endif %}
                            {% endfor %}
                            <td class="walk"></td>
                            <td class="row"><p>{{ row }}</p></td>
                        </tr>
                    {% endif %}
                {% endfor %}
            {% endfor %}
        {% endfor %}

    </tbody>

</table>
</div>
{% endblock content %}
</body>
</html>